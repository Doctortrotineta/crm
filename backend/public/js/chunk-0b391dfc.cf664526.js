(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0b391dfc"],{"011b":function(e,t,a){},"122b":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e._self._c;return t("div",[t("v-row",[t("v-col",{staticClass:"d-flex justify-center",attrs:{cols:"12"}},[t("v-card",{staticStyle:{width:"100%","max-width":"600px"}},[t("v-card-title",{staticClass:"dialog-title"},[e._v(" Edit Scooter ")]),t("v-card-text",[t("v-form",{ref:"form",attrs:{"lazy-validation":""},on:{submit:function(t){return t.preventDefault(),e.submit.apply(null,arguments)}},model:{value:e.formValid,callback:function(t){e.formValid=t},expression:"formValid"}},[t("v-container",{staticClass:"px-0",attrs:{fluid:""}},[t("v-row",[t("v-col",{attrs:{cols:"12",sm:"12"}},[t("v-text-field",{attrs:{color:"primary",label:"Name",rules:e.rules.name,required:""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),t("v-col",{attrs:{cols:"12",sm:"6"}},[t("v-text-field",{attrs:{color:"primary",label:"Phone Number",rules:e.rules.phone,required:""},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),t("v-col",{attrs:{cols:"12",sm:"6"}},[t("v-text-field",{attrs:{color:"primary",label:"Barcode",rules:e.rules.barcode,required:""},model:{value:e.form.barcode,callback:function(t){e.$set(e.form,"barcode",t)},expression:"form.barcode"}})],1),t("v-col",{attrs:{cols:"12",sm:"6"}},[t("v-text-field",{attrs:{color:"primary",label:"Model",rules:e.rules.model,required:""},model:{value:e.form.model,callback:function(t){e.$set(e.form,"model",t)},expression:"form.model"}})],1),t("v-col",{attrs:{cols:"12",sm:"6"}},[t("v-text-field",{attrs:{color:"primary",label:"TERMEN APROXIMATIV",rules:e.rules.termen,required:""},model:{value:e.form.termen,callback:function(t){e.$set(e.form,"termen",t)},expression:"form.termen"}})],1),t("v-col",{attrs:{cols:"12"}},[t("v-textarea",{attrs:{color:"primary",label:"Problem",rows:3,rules:e.rules.problem,required:""},model:{value:e.form.problem,callback:function(t){e.$set(e.form,"problem",t)},expression:"form.problem"}})],1),t("v-col",{attrs:{cols:"12"}},[t("v-textarea",{attrs:{color:"primary",label:"Notes",rows:3},model:{value:e.form.notes,callback:function(t){e.$set(e.form,"notes",t)},expression:"form.notes"}})],1),t("v-col",{attrs:{cols:"12"}},[t("v-text-field",{attrs:{color:"primary",label:"Price",rules:e.rules.price,required:""},model:{value:e.form.price,callback:function(t){e.$set(e.form,"price",t)},expression:"form.price"}})],1),t("v-col",{attrs:{cols:"12"}},[t("v-select",{attrs:{color:"primary",label:"Status",placeholder:"Select a Status",items:e.status,"item-text":"title","item-value":"id",rules:e.rules.status,required:""},model:{value:e.form.statusId,callback:function(t){e.$set(e.form,"statusId",t)},expression:"form.statusId"}})],1),e.form.statusId>1?t("v-col",{attrs:{cols:"12"}},[t("v-text-field",{attrs:{color:"primary",label:"Done By",disabled:""},model:{value:e.form.doneBy,callback:function(t){e.$set(e.form,"doneBy",t)},expression:"form.doneBy"}})],1):e._e(),t("v-col",{attrs:{cols:"12"}},[e.form.signature?t("div",{staticClass:"signature-wrapper"},[t("span",{staticClass:"text-caption"},[e._v("Signature")]),t("div",{staticClass:"signature-img"},[t("v-btn",{staticClass:"close-btn",staticStyle:{background:"#ff5252"},attrs:{"x-small":"",icon:"",color:"white"},on:{click:function(t){return e.removeSignature()}}},[t("v-icon",[e._v("mdi-close")])],1),t("v-img",{attrs:{src:e.form.signature,alt:"signature","max-height":"150","max-width":"120"}})],1)]):t("vuetify-upload",{attrs:{max:1,"can-delete":"",accept:"image/*",color:"accent"},model:{value:e.images,callback:function(t){e.images=t},expression:"images"}})],1)],1)],1)],1)],1),t("v-card-actions",{staticClass:"dialog-actions"},[t("v-spacer"),t("v-btn",{attrs:{color:"success",small:""},on:{click:e.handlePrint}},[e._v(" Print PDF ")]),t("v-btn",{attrs:{color:"primary",small:"",disabled:!e.formValid},on:{click:e.updateScooter}},[e._v(" Save ")])],1)],1)],1)],1),t("VueHtml2pdf",{ref:"html2Pdf",attrs:{"show-layout":!1,"float-layout":!0,"enable-download":!1,"preview-modal":!0,"paginate-elements-by-height":1400,filename:"download","pdf-quality":2,"manual-pagination":!1,"pdf-format":"a4","pdf-orientation":"portrait","pdf-content-width":"100%"}},[t("section",{attrs:{slot:"pdf-content"},slot:"pdf-content"},[t("pdf-content",{attrs:{item:e.form}})],1)]),t("v-snackbar",{attrs:{timeout:"3000",color:e.snackBar.type,top:"",right:""},model:{value:e.snackBar.enabled,callback:function(t){e.$set(e.snackBar,"enabled",t)},expression:"snackBar.enabled"}},[e._v(" "+e._s(e.snackBar.message)+" ")]),t("confirm-dialog",{on:{cancel:function(t){e.confirmDialog=!1},confirm:e.sendSMS},model:{value:e.confirmDialog,callback:function(t){e.confirmDialog=t},expression:"confirmDialog"}})],1)},r=[],o=function(){var e=this,t=e._self._c;return t("v-dialog",e._g(e._b({attrs:{persistent:"",width:"350",eager:""}},"v-dialog",e.$attrs,!1),e.$listeners),[t("v-sheet",{attrs:{outlined:"",color:"accent",rounded:""}},[t("v-card",[t("v-card-title",{staticClass:"dialog-title"},[e._v(" Send SMS ")]),t("v-card-text",[e._v(" Do you really want to send SMS to the client? ")]),t("v-card-actions",[t("v-btn",{staticClass:"text-capitalize btn",attrs:{small:"",color:"error"},on:{click:e.confirm}},[e._v(" Confirm ")]),t("v-btn",{staticClass:"text-capitalize btn",attrs:{small:"",color:"white"},on:{click:e.cancel}},[e._v(" Cancel ")])],1)],1)],1)],1)},i=[],l={name:"ConfirmDialog",components:{},props:{},data(){return{}},methods:{confirm(){this.$emit("confirm")},cancel(){this.$emit("cancel")}}},n=l,c=(a("47fb"),a("2877")),m=Object(c["a"])(n,o,i,!1,null,"b1eb7ef0",null),d=m.exports,u=a("8ef7"),f=a("6480"),h=a("cee4"),p={name:"EditScooter",components:{ConfirmDialog:d,PdfContent:u["a"],VueHtml2pdf:f["a"]},data(){return{items:[],form:{},images:[],rules:{name:[e=>!!e||"Name is required"],phone:[e=>!!e||"Phone Number is required"],barcode:[e=>!!e||"Barcode is required",e=>Number.isInteger(Number(e))||"Barcode must be a number",e=>this.isBarcodeUnique(e)||"Barcode already exists"],model:[e=>!!e||"Model is required"],termen:[e=>!!e||"TERMEN APROXIMATIV is required"],problem:[e=>!!e||"Problem is required"],price:[e=>Number.isInteger(Number(e))||"Price must be a number"],status:[e=>!!e||"Status is required"],imageRules:[e=>e.length>0||"This image is required"]},formValid:!0,status:[{id:1,title:"IN LUCRU"},{id:2,title:"FINALIZAT"},{id:3,title:"IESIT"}],confirmDialog:!1,snackBar:{type:"default",enabled:!1,message:""}}},created(){},mounted(){this.getScooterList(),this.getItem()},methods:{getScooterList(){this.$http.get("scooter/all").then(e=>{console.log(e),e.data&&(this.items=e.data.result)}).catch(e=>{console.log(e)})},getItem(){this.$http.get("scooter/"+this.$route.params.id).then(e=>{200===e.status&&(this.form=e.data.result)}).catch(e=>{this.snackBar.type="error",this.snackBar.enabled=!0,this.snackBar.message="Cannot get scooter item"})},isBarcodeUnique(){return!this.items.some(e=>e.barcode===this.form.barcode&&e.id!==this.form.id)},handlePrint(){this.$refs.html2Pdf.generatePdf()},removeSignature(){this.form.signature=""},validatePhoneNumber(e){const t=/^\(?([0-9]{3})\)?[-. ]?([0-9]{3})[-. ]?([0-9]{4})$/;return!!e.match(t)},async sendSMS(){if(!this.form.phone&&!this.validatePhoneNumber(this.form.phone))return this.snackBar.type="error",this.snackBar.enabled=!0,void(this.snackBar.message="Phone number is not valid!");let e="Buna ziua,\nTrotineta dvs este gata.\nCost "+this.form.price+"lei!\n\n";e+="O zi buna !\n",e+="Doctortrotineta.ro\n0723110511\nProgram luni-vineri 08.00-17.00",await Object(h["a"])({method:"GET",url:"https://secure.smslink.ro/sms/gateway/communicate/index.php",headers:{"content-type":"application/octet-stream",useQueryString:!0},params:{to:this.form.phone,message:e,connection_id:"A512757A58117C29",password:"eqZR9WUYwSFF3X6h"}}).then(e=>{if(200===e.status){const t=e.data.split(";");"ERROR"===t[0]?(this.snackBar.type="error",this.snackBar.enabled=!0,this.snackBar.message=t[2]):(this.snackBar.type="success",this.snackBar.enabled=!0,this.snackBar.message=t[2]),this.confirmDialog=!1}}).catch(e=>{console.log(e),this.snackBar.type="error",this.snackBar.enabled=!0,this.snackBar.message="Unfortunately not sent SMS to the client"})},updateScooter(){this.update=()=>{this.form.statusId>1&&(this.form.doneBy=this.$store.getters.getName),console.log(this.form),this.$http.put("scooter",this.form).then(e=>{200===e.status&&(2===this.form.statusId&&(this.confirmDialog=!0),this.getItem(),this.snackBar.type="success",this.snackBar.enabled=!0,this.snackBar.message="Successfully update Scooter")}).catch(e=>{console.log(e),this.snackBar.type="error",this.snackBar.enabled=!0,this.snackBar.message="Cannot update Scooter"})};const e=this.$refs.form.validate();e&&(this.images.length&&(this.form.signature=this.images[0].preview),this.update())}}},b=p,v=(a("ec04"),Object(c["a"])(b,s,r,!1,null,"0b997480",null));t["default"]=v.exports},"47fb":function(e,t,a){"use strict";a("011b")},"6e61":function(e,t,a){},ec04:function(e,t,a){"use strict";a("6e61")}}]);
//# sourceMappingURL=chunk-0b391dfc.cf664526.js.map